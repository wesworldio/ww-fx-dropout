# WesWorld FX

![Example Output](examples/2025-11-27-02.28.37.gif)

Creative custom face filters with distortion effects that integrate with OBS via virtual camera.

## Features

## Installation

### Prerequisites
- Python 3.11 or later
- pip (Python package manager)

### Install Dependencies

**macOS/Linux:**
```bash
make install
```

**Windows:**
```bash
pip install -r requirements.txt
```

Or manually on any platform:
```bash
pip install -r requirements.txt
```


### Examples

Comparison images showing before/after effects for each filter (ordered by UI position):

#### 1. SAM REICH Tattoo
![SAM REICH Tattoo](docs/comparison_sam_reich.jpg)

#### 2. Sam Face Mask
![Sam Face Mask](docs/comparison_sam_face_mask.jpg)

#### 3. Extreme Close-Up
![](docs/ww.gif)
![Extreme Close-Up](docs/comparison_extreme_closeup.jpg)

#### 4. Puzzle
![Puzzle](docs/comparison_puzzle.jpg)

#### 5. Fast Zoom In
![Fast Zoom In](docs/comparison_fast_zoom_in.jpg)

#### 6. Fast Zoom Out
![Fast Zoom Out](docs/comparison_fast_zoom_out.jpg)

#### 7. Shake
![Shake](docs/comparison_shake.jpg)

#### 8. Pulse
![Pulse](docs/comparison_pulse.jpg)

#### 9. Spiral Zoom
![Spiral Zoom](docs/comparison_spiral_zoom.jpg)

#### 10. Bulge
![Bulge](docs/comparison_bulge.jpg)

#### 11. Stretch
![Stretch](docs/comparison_stretch.jpg)

#### 12. Swirl
![Swirl](docs/comparison_swirl.jpg)

#### 13. Fisheye
![Fisheye](docs/comparison_fisheye.jpg)

#### 14. Pinch
![Pinch](docs/comparison_pinch.jpg)

#### 15. Wave
![Wave](docs/comparison_wave.jpg)

#### 16. Mirror
![Mirror](docs/comparison_mirror.jpg)

#### 17. Twirl
![Twirl](docs/comparison_twirl.jpg)

#### 18. Ripple
![Ripple](docs/comparison_ripple.jpg)

#### 19. Sphere
![Sphere](docs/comparison_sphere.jpg)

#### 20. Tunnel
![Tunnel](docs/comparison_tunnel.jpg)

#### 21. Water Ripple
![Water Ripple](docs/comparison_water_ripple.jpg)

#### 22. Radial Blur
![Radial Blur](docs/comparison_radial_blur.jpg)

#### 23. Cylinder
![Cylinder](docs/comparison_cylinder.jpg)

#### 24. Barrel
![Barrel](docs/comparison_barrel.jpg)

#### 25. Pincushion
![Pincushion](docs/comparison_pincushion.jpg)

#### 26. Whirlpool
![Whirlpool](docs/comparison_whirlpool.jpg)

#### 27. Radial Zoom
![Radial Zoom](docs/comparison_radial_zoom.jpg)

#### 28. Concave
![Concave](docs/comparison_concave.jpg)

#### 29. Convex
![Convex](docs/comparison_convex.jpg)

#### 30. Spiral
![Spiral](docs/comparison_spiral.jpg)

#### 31. Radial Stretch
![Radial Stretch](docs/comparison_radial_stretch.jpg)

#### 32. Radial Compress
![Radial Compress](docs/comparison_radial_compress.jpg)

#### 33. Vertical Wave
![Vertical Wave](docs/comparison_vertical_wave.jpg)

#### 34. Horizontal Wave
![Horizontal Wave](docs/comparison_horizontal_wave.jpg)

#### 35. Skew Horizontal
![Skew Horizontal](docs/comparison_skew_horizontal.jpg)

#### 36. Skew Vertical
![Skew Vertical](docs/comparison_skew_vertical.jpg)

#### 37. Rotate Zoom
![Rotate Zoom](docs/comparison_rotate_zoom.jpg)

#### 38. Radial Wave
![Radial Wave](docs/comparison_radial_wave.jpg)

#### 39. Zoom In
![Zoom In](docs/comparison_zoom_in.jpg)

#### 40. Zoom Out
![Zoom Out](docs/comparison_zoom_out.jpg)

#### 41. Rotate
![Rotate](docs/comparison_rotate.jpg)

#### 42. Rotate 45°
![Rotate 45°](docs/comparison_rotate_45.jpg)

#### 43. Rotate 90°
![Rotate 90°](docs/comparison_rotate_90.jpg)

#### 44. Flip Horizontal
![Flip Horizontal](docs/comparison_flip_horizontal.jpg)

#### 45. Flip Vertical
![Flip Vertical](docs/comparison_flip_vertical.jpg)

#### 46. Flip Both
![Flip Both](docs/comparison_flip_both.jpg)

#### 47. Quad Mirror
![Quad Mirror](docs/comparison_quad_mirror.jpg)

#### 48. Tile
![Tile](docs/comparison_tile.jpg)

#### 49. Radial Tile
![Radial Tile](docs/comparison_radial_tile.jpg)

#### 50. Zoom Blur
![Zoom Blur](docs/comparison_zoom_blur.jpg)

#### 51. Melt
![Melt](docs/comparison_melt.jpg)

#### 52. Kaleidoscope
![Kaleidoscope](docs/comparison_kaleidoscope.jpg)

#### 53. Glitch
![Glitch](docs/comparison_glitch.jpg)

#### 54. Double Vision
![Double Vision](docs/comparison_double_vision.jpg)

#### 55. Black & White
![Black & White](docs/comparison_black_white.jpg)

#### 56. Sepia
![Sepia](docs/comparison_sepia.jpg)

#### 57. Vintage
![Vintage](docs/comparison_vintage.jpg)

#### 58. Neon Glow
![Neon Glow](docs/comparison_neon_glow.jpg)

#### 59. Pixelate
![Pixelate](docs/comparison_pixelate.jpg)

#### 60. Blur
![Blur](docs/comparison_blur.jpg)

#### 61. Sharpen
![Sharpen](docs/comparison_sharpen.jpg)

#### 62. Emboss
![Emboss](docs/comparison_emboss.jpg)

#### 63. Red Tint
![Red Tint](docs/comparison_red_tint.jpg)

#### 64. Blue Tint
![Blue Tint](docs/comparison_blue_tint.jpg)

#### 65. Green Tint
![Green Tint](docs/comparison_green_tint.jpg)

#### 66. Rainbow
![Rainbow](docs/comparison_rainbow.jpg)

#### 67. Negative
![Negative](docs/comparison_negative.jpg)

#### 68. Posterize
![Posterize](docs/comparison_posterize.jpg)

#### 69. Sketch
![Sketch](docs/comparison_sketch.jpg)

#### 70. Cartoon
![Cartoon](docs/comparison_cartoon.jpg)

#### 71. Thermal
![Thermal](docs/comparison_thermal.jpg)

#### 72. Ice
![Ice](docs/comparison_ice.jpg)

#### 73. Ocean
![Ocean](docs/comparison_ocean.jpg)

#### 74. Plasma
![Plasma](docs/comparison_plasma.jpg)

#### 75. Jet
![Jet](docs/comparison_jet.jpg)

#### 76. Turbo
![Turbo](docs/comparison_turbo.jpg)

#### 77. Inferno
![Inferno](docs/comparison_inferno.jpg)

#### 78. Magma
![Magma](docs/comparison_magma.jpg)

#### 79. Viridis
![Viridis](docs/comparison_viridis.jpg)

#### 80. Cool
![Cool](docs/comparison_cool.jpg)

#### 81. Hot
![Hot](docs/comparison_hot.jpg)

#### 82. Spring
![Spring](docs/comparison_spring.jpg)

#### 83. Summer
![Summer](docs/comparison_summer.jpg)

#### 84. Autumn
![Autumn](docs/comparison_autumn.jpg)

#### 85. Winter
![Winter](docs/comparison_winter.jpg)

#### 86. Rainbow Shift
![Rainbow Shift](docs/comparison_rainbow_shift.jpg)

#### 87. Acid Trip
![Acid Trip](docs/comparison_acid_trip.jpg)

#### 88. VHS
![VHS](docs/comparison_vhs.jpg)

#### 89. Retro
![Retro](docs/comparison_retro.jpg)

#### 90. Cyberpunk
![Cyberpunk](docs/comparison_cyberpunk.jpg)

#### 91. Anime
![Anime](docs/comparison_anime.jpg)

#### 92. Glow
![Glow](docs/comparison_glow.jpg)

#### 93. Solarize
![Solarize](docs/comparison_solarize.jpg)

#### 94. Edge Detect
![Edge Detect](docs/comparison_edge_detect.jpg)

#### 95. Halftone
![Halftone](docs/comparison_halftone.jpg)

**macOS/Linux (using Makefile):**
```bash
make run-bulge
make run-stretch
make run-swirl
make run-fisheye
make run-pinch
make run-wave
make run-mirror
```

**Windows (direct Python):**
```bash
python face_filters.py bulge
python face_filters.py stretch
python face_filters.py swirl
python face_filters.py fisheye
python face_filters.py pinch
python face_filters.py wave
python face_filters.py mirror
```

### Custom Resolution/FPS

**macOS/Linux:**
```bash
WIDTH=1920 HEIGHT=1080 FPS=60 make run-bulge
```

**Windows (Command Prompt):**
```cmd
set WIDTH=1920 && set HEIGHT=1080 && set FPS=60 && python face_filters.py bulge
```

**Windows (PowerShell):**
```powershell
$env:WIDTH=1920; $env:HEIGHT=1080; $env:FPS=60; python face_filters.py bulge
```

### Interactive Mode (Recommended for Testing)

Switch between filters in real-time using keyboard keys:

**macOS/Linux:**
```bash
make interactive
```

**Windows:**
```bash
python interactive_filters.py
```

This opens a Python window where you can:
- Press **Arrow Left/Right** to cycle through all 50+ filters
- Press **1-7** for quick access to basic filters
- Press **0** to see the original (no filter)
- Press **Q** to quit
- See the current filter name displayed on screen

Perfect for testing and comparing filters without restarting the application!

**Example comparison images** are available in the `docs/` folder showing before/after effects.

### Preview-Only Mode (Testing)

For testing a single filter without virtual camera or OBS:

**macOS/Linux:**
```bash
make preview-bulge
make preview-stretch
make preview-swirl
# ... etc for any filter
```

**Windows:**
```bash
python face_filters.py bulge --preview-only
python face_filters.py stretch --preview-only
python face_filters.py swirl --preview-only
# ... etc for any filter
```

This opens a Python window showing the filtered video feed - perfect for testing filters before using them in OBS.

### Direct Python Usage

**macOS/Linux:**
```bash
python3 face_filters.py <filter-type> [options]
```

**Windows:**
```bash
python face_filters.py <filter-type> [options]
```

Options:
- `--width`: Camera width (default: 1280)
- `--height`: Camera height (default: 720)
- `--fps`: Frames per second (default: 30)
- `--preview`: Show preview window (default: True)
- `--no-preview`: Hide preview window
- `--preview-only`: Preview window only, no virtual camera (for testing)

Example:
```bash
python face_filters.py swirl --width 1920 --height 1080 --fps 60 --preview-only
```

**Note:** Use `python3` on macOS/Linux if `python` points to Python 2, or `python` on Windows. Adjust based on your system's Python installation.

## Web-Based Version

Access the filters through your web browser! Perfect for OBS Browser Source integration.

### Starting the Web Server

**macOS/Linux:**
```bash
make web
```

**Windows:**
```bash
python web_server.py
```

Or directly with uvicorn:
```bash
uvicorn web_server:app --host 0.0.0.0 --port 8000
```

### Using the Web Interface

1. Start the web server (see above)
2. Open your browser and navigate to `http://localhost:9000`
3. Click "Show Controls" button (bottom right) to access settings
4. Select your camera from the dropdown
5. Click "Start Camera" to begin
6. Select a filter from the dropdown menu
7. The filtered video feed will appear in the browser

### OBS Browser Source Integration

The web interface is designed to be minimal - perfect for OBS Browser Source:

1. Start the web server: `make web` or `python web_server.py`
2. In OBS, add a **Browser Source**
3. Set the URL to: `http://localhost:9000` (or your server IP if remote)
4. Set width: `1920` and height: `1080` (or your preferred resolution)
5. Check "Shutdown source when not visible" if desired
6. The filtered video feed will appear in OBS
7. You can hide the controls by clicking "Hide Controls" - the video feed will remain visible

**Note:** For remote access, use your server's IP address instead of `localhost` (e.g., `http://192.168.1.100:9000`)

### Features

- **Camera Selection**: Choose from all available cameras on your device
- **Real-time Processing**: All filters applied in real-time via WebSocket
- **Minimal UI**: Controls can be hidden for clean OBS capture
- **All Filters Available**: Access to all 90+ filters through the web interface
- **Cross-platform**: Works on any device with a modern web browser

## OBS Integration

### Option 1: Virtual Camera (Recommended)

1. Install OBS 30.0 or later
2. In OBS, go to **Tools → Start Virtual Camera** (this installs the system extension)
3. Grant camera permissions when prompted:
   - **macOS**: System Settings → Privacy & Security → Camera
   - **Windows**: Windows Settings → Privacy → Camera (allow desktop apps)
4. Start a filter:
   - **macOS/Linux**: `make run-<filter-name>` (e.g., `make run-bulge`)
   - **Windows**: `python face_filters.py <filter-name>` (e.g., `python face_filters.py bulge`)
5. The filter will automatically detect and use the OBS Virtual Camera backend
6. In OBS, add a new **Video Capture Device** source
7. Select the virtual camera from the device dropdown
8. The filtered video feed will appear in OBS

### Option 2: Window Capture (Fallback)

If virtual camera is not available, the filter runs in preview-only mode:

1. Start a filter:
   - **macOS/Linux**: `make run-<filter-name>` or `make preview-<filter-name>`
   - **Windows**: `python face_filters.py <filter-name> --preview-only`
2. A preview window will appear showing the filtered video
3. In OBS, add a new **Window Capture** source
4. Select the "WesWorld FX - Preview" window
5. The filtered video feed will appear in OBS

## All Available Filters

### Distortion Filters
`bulge`, `stretch`, `swirl`, `fisheye`, `pinch`, `wave`, `mirror`, `zoom_blur`, `melt`, `double_vision`

### Color Filters  
`black_white`, `sepia`, `vintage`, `negative`, `rainbow`, `rainbow_shift`, `red_tint`, `blue_tint`, `green_tint`

### Color Map Filters
`thermal`, `ice`, `ocean`, `plasma`, `jet`, `turbo`, `inferno`, `magma`, `viridis`, `cool`, `hot`, `spring`, `summer`, `autumn`, `winter`

### Artistic Filters
`sketch`, `cartoon`, `anime`, `posterize`, `halftone`, `edge_detect`, `solarize`

### Special Effects
`sam_reich` - SAM REICH forehead tattoo (always tracks face)
`neon_glow`, `glow`, `pixelate`, `blur`, `sharpen`, `emboss`, `kaleidoscope`, `glitch`, `vhs`, `retro`, `cyberpunk`, `acid_trip`


To use any filter:

**macOS/Linux:**
```bash
python3 face_filters.py <filter-name> --preview-only
```

**Windows:**
```bash
python face_filters.py <filter-name> --preview-only
```

For example:
```bash
python face_filters.py sam_reich --preview-only
python face_filters.py cyberpunk --preview-only
python face_filters.py cartoon --preview-only
```

## Testing

WesWorld FX includes end-to-end (E2E) tests using Playwright to validate web functionality.

### Installing Test Dependencies

**macOS/Linux:**
```bash
make test-install
```

**Windows:**
```bash
pip install -r requirements-test.txt
python -m playwright install chromium
```

### Running Tests

**macOS/Linux:**
```bash
make test-e2e
```

**Windows:**
```bash
pytest tests/test_web_e2e.py -v
```

### Running Tests in Headed Mode (Visible Browser)

For debugging, run tests with a visible browser:

**macOS/Linux:**
```bash
make test-e2e-headed
```

**Windows:**
```bash
set PLAYWRIGHT_HEADLESS=false && pytest tests/test_web_e2e.py -v -s
```

### What Tests Cover

The E2E test suite validates:
- ✅ Web server startup and page serving
- ✅ UI elements and layout
- ✅ Camera selection functionality
- ✅ Filter list loading and selection
- ✅ API endpoints (`/api/filters`)
- ✅ WebSocket connection establishment
- ✅ Control visibility toggling
- ✅ Responsive layout at different viewport sizes
- ✅ Filter processing and application
- ✅ Multiple filter categories (distortion, color, effects, etc.)

### Filter Validation

To validate that filters are working correctly with the web server:

**macOS/Linux:**
```bash
# In one terminal, start the server
make web

# In another terminal, validate filters
make validate-filters
```

**Windows:**
```bash
# Terminal 1: Start server
python web_server.py

# Terminal 2: Validate filters
python scripts/validate_filters.py
```

This will test that filters can be applied to test frames and verify the processing pipeline.

**Note:** Make sure the web server is NOT running when executing E2E tests, as the test suite will start its own instance. However, `validate-filters` requires the server to be running.

For detailed testing documentation, see [docs/testing.md](docs/testing.md).

## Troubleshooting

### Camera Not Found
- Ensure your camera is connected and not in use by another application
- Grant camera permissions:
  - **macOS**: System Settings → Privacy & Security → Camera
  - **Windows**: Windows Settings → Privacy → Camera
- Test camera availability:
  - **macOS/Linux**: `make test`
  - **Windows**: `python -c "import cv2; print(cv2.VideoCapture(0).isOpened())"`

### Virtual Camera Not Appearing in OBS
- Install OBS 30.0+ and enable Virtual Camera in OBS (**Tools → Start Virtual Camera**)
- Grant camera permissions:
  - **macOS**: System Settings → Privacy & Security → Camera
  - **Windows**: Windows Settings → Privacy → Camera (allow desktop apps)
- Restart your machine after installing OBS Virtual Camera system extension
- The filter will automatically fall back to preview-only mode if virtual camera is unavailable
- Use Window Capture in OBS to capture the preview window as an alternative

### Performance Issues
- Reduce resolution:
  - **macOS/Linux**: `WIDTH=640 HEIGHT=480 make run-bulge`
  - **Windows**: `python face_filters.py bulge --width 640 --height 480`
- Lower FPS:
  - **macOS/Linux**: `FPS=15 make run-bulge`
  - **Windows**: `python face_filters.py bulge --fps 15`

## Stopping Filters

Press `Ctrl+C` in the terminal (or `Ctrl+Break` on Windows) to stop the filter.

